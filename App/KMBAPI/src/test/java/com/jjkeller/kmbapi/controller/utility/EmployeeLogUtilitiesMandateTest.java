package com.jjkeller.kmbapi.controller.utility;

import com.jjkeller.kmbapi.TestableTimeKeeper;
import com.jjkeller.kmbapi.common.JsonUtil;
import com.jjkeller.kmbapi.common.TestBase;
import com.jjkeller.kmbapi.common.TimeKeeper;
import com.jjkeller.kmbapi.configuration.GlobalState;
import com.jjkeller.kmbapi.configuration.LoginCredentials;
import com.jjkeller.kmbapi.configuration.UserState;
import com.jjkeller.kmbapi.controller.ControllerFactory;
import com.jjkeller.kmbapi.controller.EmployeeLogAobrdController;
import com.jjkeller.kmbapi.controller.dataaccess.EmployeeLogFacade;
import com.jjkeller.kmbapi.controller.share.User;
import com.jjkeller.kmbapi.employeelogeldevents.EmployeeLogEldEventCode;
import com.jjkeller.kmbapi.employeelogeldevents.Enums;
import com.jjkeller.kmbapi.enums.DriverTypeEnum;
import com.jjkeller.kmbapi.enums.DutyStatusEnum;
import com.jjkeller.kmbapi.enums.RuleSetTypeEnum;
import com.jjkeller.kmbapi.enums.TimeZoneEnum;
import com.jjkeller.kmbapi.featuretoggle.FeatureToggleService;
import com.jjkeller.kmbapi.proxydata.CompanyConfigSettings;
import com.jjkeller.kmbapi.proxydata.EldEventAdapterList;
import com.jjkeller.kmbapi.proxydata.EmployeeLog;
import com.jjkeller.kmbapi.proxydata.EmployeeLogEldEvent;
import com.jjkeller.kmbapi.proxydata.EmployeeLogEldEventList;
import com.jjkeller.kmbapi.proxydata.Location;

import junit.framework.Assert;

import org.joda.time.DateTime;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.robolectric.RobolectricTestRunner;
import org.robolectric.RuntimeEnvironment;
import org.robolectric.annotation.Config;

import java.lang.reflect.Field;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.TimeZone;
import java.util.concurrent.TimeUnit;

import static junit.framework.Assert.assertEquals;
import static junit.framework.Assert.assertNull;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

/**
 * Tests for EmployeeLogUtilities.java
 *
 * Created by jld5296 on 10/26/16.
 */
@RunWith(RobolectricTestRunner.class)
@Config(application = GlobalState.class,
        manifest = "/build/intermediates/bundles/encompass/debug/AndroidManifest.xml"
)
public class EmployeeLogUtilitiesMandateTest extends TestBase {

    private GlobalState globalState;
    private FeatureToggleService ftService;
    private EmployeeLogAobrdController employeeLogController;
    private EmployeeLog employeeLog;
    private RuleSetTypeEnum ruleType = new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR);

    protected EmployeeLogFacade employeeLogFacade;

    private DutyStatusEnum OFF_DUTY = new DutyStatusEnum(DutyStatusEnum.OFFDUTY);
    private DutyStatusEnum ON_DUTY = new DutyStatusEnum(DutyStatusEnum.ONDUTY);
    private DutyStatusEnum DRIVING = new DutyStatusEnum(DutyStatusEnum.DRIVING);
    private DutyStatusEnum SLEEPER = new DutyStatusEnum(DutyStatusEnum.SLEEPER);


    private final DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss", Locale.US);


    private void addDutyStatyChange(Date time, DutyStatusEnum status, boolean manual){
        try {
            employeeLogController.CreateDutyStatusChangedEvent(employeeLog,time, status, new Location(), true, ruleType, null, null , manual, null, null);
        } catch (Throwable throwable) {
            throw new RuntimeException(throwable);
        }

    }

    private static EmployeeLogEldEvent createEldEvent(Enums.EmployeeLogEldEventType eventType, Enums.EmployeeLogEldEventRecordStatus recordStatus, DateTime eventDateTime, int dutyStatusEnum){


        EmployeeLogEldEvent eldEvent = new EmployeeLogEldEvent(eventDateTime.toDate(), new EmployeeLogEldEventCode(dutyStatusEnum), eventType);
        eldEvent.setEventRecordStatus(recordStatus.getValue());
        eldEvent.setDutyStatusEnum(new DutyStatusEnum(dutyStatusEnum));

        return eldEvent;
    }


    @Before
    public void setUp() throws Exception {
        globalState = (GlobalState) RuntimeEnvironment.application;

        ftService = mock(FeatureToggleService.class);
        when(ftService.getIsEldMandateEnabled()).thenReturn(true);


        Field field = GlobalState.class.getDeclaredField("_featureToggleService");
        field.setAccessible(true);
        field.set(globalState, ftService);

        LoginCredentials credentials = mock(LoginCredentials.class);
        when(credentials.getEmployeeId()).thenReturn("12345678-1234-1234-1234-123456789012");


        User user = mock(User.class);
        UserState userState = new UserState();
        when(user.getCredentials()).thenReturn(credentials);
        when(user.getCredentials()).thenReturn(credentials);
        when(user.getUserState()).thenReturn(userState);
        when(user.getHomeTerminalTimeZone()).thenReturn(TimeZoneEnum.CENTRAL_STANDARD_TIME);
        when(user.getRulesetTypeEnum()).thenReturn(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        when(user.getDriverType()).thenReturn(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));

        CompanyConfigSettings settings = new CompanyConfigSettings();
        settings.setDailyLogStartTime("00:00");
        settings.setDmoCompanyName("Roman Corp");
        globalState.setCompanyConfigSettings(globalState, settings);


        ArrayList<User> userList = new ArrayList<User>();
        userList.add(user);
        globalState.setLoggedInUserList(userList);
        globalState.setCurrentUser(user);

        Date date = dateFormat.parse("2017-07-01 00:00:00");
        employeeLog = EmployeeLogUtilities.CreateNewLog(globalState, user, date, DutyStatusEnum.valueOfDMOEnum(DutyStatusEnum.DmoEnum_OffDuty), null);
        globalState.setCurrentEmployeeLog(employeeLog);

        employeeLogController = ControllerFactory.getInstance().getEmployeeLogAobrdController();
        employeeLogFacade = new EmployeeLogFacade(globalState, user);


    }

    @After
    public void tearDown() throws NoSuchFieldException, IllegalAccessException {
        closeDatabase(globalState);
        employeeLog = null;
        ftService = null;
    }

    @Test
    public void calculateLogEndTime() throws Exception {
        String dailyLogStartime = "02:29:45";

        TimeZoneEnum homeTerm = TimeZoneEnum.PACIFIC_STANDARD_TIME;

        Calendar cal = Calendar.getInstance(homeTerm.toTimeZone());
        cal.set(2016, Calendar.OCTOBER, 20, 16, 25, 55);
        Date input = cal.getTime();

        cal.set(2016, Calendar.OCTOBER, 21, 2, 29, 44);
        Date expected = cal.getTime();

        Date actual = EmployeeLogUtilities.CalculateLogEndTime(dailyLogStartime, input, homeTerm);

        AssertDateAndTimeIsEqual(expected, actual);
    }

    @Test
    public void calculateLogStartTime() throws Exception {
        Calendar calendar = Calendar.getInstance();
        calendar.set(2016, Calendar.OCTOBER, 26, 16, 45, 5);
        calendar.setTimeZone(TimeZone.getTimeZone("PST"));
        Date logDate = calendar.getTime();

        Date actual = EmployeeLogUtilities.CalculateLogStartTime("02:30:15", logDate, TimeZoneEnum.PACIFIC_STANDARD_TIME);

        calendar.set(2016, Calendar.OCTOBER, 26, 2, 30, 15);
        Date expected = calendar.getTime();

        AssertDateAndTimeIsEqual(expected, actual);
    }

    // Need to actually test the components of the Date and Time, because Assert.Equals(date, date) does a reference comparison, not actual values
    private void AssertDateAndTimeIsEqual(Date expected, Date actual) {
        Calendar calExpected = Calendar.getInstance();
        calExpected.setTime(expected);

        Calendar calActual = Calendar.getInstance();
        calActual.setTime(actual);
        Assert.assertEquals(calExpected.get(Calendar.YEAR), calActual.get(Calendar.YEAR));
        Assert.assertEquals(calExpected.get(Calendar.DAY_OF_YEAR), calActual.get(Calendar.DAY_OF_YEAR));
        Assert.assertEquals(calExpected.get(Calendar.HOUR_OF_DAY), calActual.get(Calendar.HOUR_OF_DAY));
        Assert.assertEquals(calExpected.get(Calendar.MINUTE), calActual.get(Calendar.MINUTE));
        Assert.assertEquals(calExpected.get(Calendar.SECOND), calActual.get(Calendar.SECOND));
    }



    @Test
    public void CalculateLogEventTotal_FilledLog_CorrectCalculationsAreDone(){
        User user = new User();
        LoginCredentials credentials = new LoginCredentials();
        credentials.setEmployeeId("Unit Testing Employee");

        user.setCredentials(credentials);
        GlobalState.getInstance().setCurrentUser(user);

        EmployeeLog employeeLog = new EmployeeLog();
        DateTime currentClockTime = new DateTime(2017, 4, 10, 14, 0);

        EmployeeLogEldEvent[] eldEvents = new EmployeeLogEldEvent[6];
        eldEvents[0] = createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 4, 10, 10, 30), DutyStatusEnum.ONDUTY);
        eldEvents[1] = createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 4, 10, 10, 40), DutyStatusEnum.DRIVING);
        eldEvents[2] = createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 4, 10, 10, 50), DutyStatusEnum.OFFDUTY);
        eldEvents[3] = createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 4, 10, 11,  0), DutyStatusEnum.ONDUTY);
        eldEvents[4] = createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 4, 10, 11, 30), DutyStatusEnum.DRIVING);
        eldEvents[5] = createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 4, 10, 13, 30), DutyStatusEnum.OFFDUTY);


        EmployeeLogEldEventList eldEventList = new EmployeeLogEldEventList();
        eldEventList.setEldEventList(eldEvents);

        employeeLog.setEldEventList(eldEventList);


        Assert.assertEquals(130, EmployeeLogUtilities.CalculateLogEventTotal(employeeLog, new DutyStatusEnum(DutyStatusEnum.DRIVING), currentClockTime.toDate(), TimeUnit.MINUTES));
        Assert.assertEquals(40, EmployeeLogUtilities.CalculateLogEventTotal(employeeLog, new DutyStatusEnum(DutyStatusEnum.ONDUTY), currentClockTime.toDate(), TimeUnit.MINUTES));
        Assert.assertEquals(40, EmployeeLogUtilities.CalculateLogEventTotal(employeeLog, new DutyStatusEnum(DutyStatusEnum.OFFDUTY), currentClockTime.toDate(), TimeUnit.MINUTES));

        Assert.assertEquals(7800000, EmployeeLogUtilities.CalculateLogEventTotal(employeeLog, new DutyStatusEnum(DutyStatusEnum.DRIVING), currentClockTime.toDate(), TimeUnit.MILLISECONDS));
        Assert.assertEquals(2400000, EmployeeLogUtilities.CalculateLogEventTotal(employeeLog, new DutyStatusEnum(DutyStatusEnum.ONDUTY), currentClockTime.toDate(), TimeUnit.MILLISECONDS));
        Assert.assertEquals(2400000, EmployeeLogUtilities.CalculateLogEventTotal(employeeLog, new DutyStatusEnum(DutyStatusEnum.OFFDUTY), currentClockTime.toDate(), TimeUnit.MILLISECONDS));
    }




    @Test
    public void getNextActiveEventAfterDateSortedTest(){
        User user = new User();
        LoginCredentials credentials = new LoginCredentials();
        credentials.setEmployeeId("Unit Testing Employee");

        user.setCredentials(credentials);
        GlobalState.getInstance().setCurrentUser(user);

        List<EmployeeLogEldEvent> eldEvents = new ArrayList<>();

        eldEvents.add(createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 5, 11, 10, 30), DutyStatusEnum.ONDUTY));
        eldEvents.add(createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 4, 11, 10, 40), DutyStatusEnum.DRIVING));
        eldEvents.add(createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 4, 11, 10, 51), DutyStatusEnum.OFFDUTY));
        eldEvents.add(createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 2, 10, 11,  0), DutyStatusEnum.ONDUTY));
        eldEvents.add(createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 4, 13, 11, 30), DutyStatusEnum.DRIVING));
        eldEvents.add(createEldEvent(Enums.EmployeeLogEldEventType.DutyStatusChange, Enums.EmployeeLogEldEventRecordStatus.Active, new DateTime(2017, 3, 18, 13, 30), DutyStatusEnum.OFFDUTY));

        EmployeeLogEldEvent next = EmployeeLogUtilities.getNextActiveEventAfterDate(eldEvents, new DateTime(2017, 5, 11, 10, 30).toDate());
        assertNull("last event", next);

        // date way in the future
        next = EmployeeLogUtilities.getNextActiveEventAfterDate(eldEvents, new DateTime(2019, 12, 11, 2, 30).toDate());
        assertNull("last event", next);

        next = EmployeeLogUtilities.getNextActiveEventAfterDate(eldEvents, new DateTime(2017, 4, 11, 10, 40).toDate());
        assertEquals("wrong event returned", next.getEventDateTime().getTime(), new DateTime(2017, 4, 11, 10, 51).getMillis());


        next = EmployeeLogUtilities.getNextActiveEventAfterDate(eldEvents, new DateTime(2017, 3, 18, 13, 30).toDate());
        assertEquals("wrong event returned", next.getEventDateTime().getTime(), new DateTime(2017, 4, 11, 10, 40).getMillis());

        /// date not in list..
        next = EmployeeLogUtilities.getNextActiveEventAfterDate(eldEvents, new DateTime(2015, 1, 1, 1, 1).toDate());
        assertEquals("wrong event returned", next.getEventDateTime().getTime(), new DateTime(2017, 2, 10, 11,  0).getMillis());

    }


    @Test
    public void test_CombineLogEvents_SingleLogEvent() {
        EmployeeLogEldEvent[] originalEvents = new EmployeeLogEldEvent[]{new EmployeeLogEldEvent(), new EmployeeLogEldEvent()};
        EmployeeLogEldEventList originalEventList = new EmployeeLogEldEventList();
        originalEventList.setEldEventList(originalEvents);

        EmployeeLogEldEventList target = EmployeeLogUtilities.CombineLogEvents(originalEventList, new EmployeeLogEldEvent());

        Assert.assertEquals(3, target.getEldEventList().length);
    }

    @Test
    public void test_CombineLogEvents_SingleLogEvent_NullLogEvent() {
        EmployeeLogEldEvent[] originalEvents = new EmployeeLogEldEvent[]{new EmployeeLogEldEvent(), new EmployeeLogEldEvent()};
        EmployeeLogEldEventList originalEventList = new EmployeeLogEldEventList();
        originalEventList.setEldEventList(originalEvents);

        EmployeeLogEldEventList target = EmployeeLogUtilities.CombineLogEvents(originalEventList, (EmployeeLogEldEvent) null);

        Assert.assertEquals(2, target.getEldEventList().length);
    }

    @Test
    public void test_CombineLogEvents_SingleLogEvent_EmptyList() {
        EmployeeLogEldEventList originalEventList = new EmployeeLogEldEventList();

        EmployeeLogEldEventList target = EmployeeLogUtilities.CombineLogEvents(originalEventList, new EmployeeLogEldEvent());

        Assert.assertEquals(1, target.getEldEventList().length);
    }

    @Test
    public void test_CombineLogEvents_Lists() throws ParseException {
        EmployeeLogEldEvent[] originalEvents;

        originalEvents = new EmployeeLogEldEvent[]{new EmployeeLogEldEvent(dateFormat.parse("2015-08-01 00:00:00")), new EmployeeLogEldEvent(dateFormat.parse("2015-08-02 00:00:00"))};

        EmployeeLogEldEventList originalEventList = new EmployeeLogEldEventList();
        originalEventList.setEldEventList(originalEvents);

        EmployeeLogEldEvent[] additionalEvents = new EmployeeLogEldEvent[]{new EmployeeLogEldEvent(dateFormat.parse("2015-08-03 00:00:00")), new EmployeeLogEldEvent(dateFormat.parse("2015-08-04 00:00:00"))};
        EmployeeLogEldEventList additionalEventList = new EmployeeLogEldEventList();
        additionalEventList.setEldEventList(additionalEvents);

        EmployeeLogEldEventList target = EmployeeLogUtilities.CombineLogEvents(originalEventList, additionalEventList);

        Assert.assertEquals(4, target.getEldEventList().length);
    }

    @Test
    public void test_CombineLogEvents_EmptyOriginalList() {
        EmployeeLogEldEvent[] originalEvents = new EmployeeLogEldEvent[]{new EmployeeLogEldEvent(), new EmployeeLogEldEvent()};
        EmployeeLogEldEventList originalEventList = new EmployeeLogEldEventList();
        originalEventList.setEldEventList(originalEvents);

        EmployeeLogEldEventList additionalEventList = new EmployeeLogEldEventList();

        EmployeeLogEldEventList target = EmployeeLogUtilities.CombineLogEvents(originalEventList, additionalEventList);

        Assert.assertEquals(2, target.getEldEventList().length);
    }

    @Test
    public void test_CombineLogEvents_EmptyAdditionalList() {
        EmployeeLogEldEventList originalEventList = new EmployeeLogEldEventList();

        EmployeeLogEldEvent[] additionalEvents = new EmployeeLogEldEvent[]{new EmployeeLogEldEvent(), new EmployeeLogEldEvent()};
        EmployeeLogEldEventList additionalEventList = new EmployeeLogEldEventList();
        additionalEventList.setEldEventList(additionalEvents);

        EmployeeLogEldEventList target = EmployeeLogUtilities.CombineLogEvents(originalEventList, additionalEventList);

        Assert.assertEquals(2, target.getEldEventList().length);
    }

    @Test
    public void test_CombineLogEvents_DontAddDuplicates() throws ParseException {
        EmployeeLogEldEvent[] originalEvents = new EmployeeLogEldEvent[]{new EmployeeLogEldEvent(dateFormat.parse("2015-08-01 00:00:00")), new EmployeeLogEldEvent(dateFormat.parse("2015-08-02 00:00:00"))};
        EmployeeLogEldEventList originalEventList = new EmployeeLogEldEventList();
        originalEventList.setEldEventList(originalEvents);

        EmployeeLogEldEvent[] additionalEvents = new EmployeeLogEldEvent[]{new EmployeeLogEldEvent(dateFormat.parse("2015-08-02 00:00:00")), new EmployeeLogEldEvent(dateFormat.parse("2015-08-03 00:00:00"))};
        EmployeeLogEldEventList additionalEventList = new EmployeeLogEldEventList();
        additionalEventList.setEldEventList(additionalEvents);

        EmployeeLogEldEventList target = EmployeeLogUtilities.CombineLogEvents(originalEventList, additionalEventList);

        //only 3, because 2015-08-02 was duplicated
        Assert.assertEquals(3, target.getEldEventList().length);
    }

    @Test
    public void test_RemoveDuplicateEventIfExistsMandate() throws ParseException{
        GlobalState.getInstance().setCurrentDriversLog(employeeLog);

        Date offDutyTime1 = dateFormat.parse("2017-07-01 01:10:00");
        addDutyStatyChange(offDutyTime1, OFF_DUTY, true);

        Date onDutyTime1 = dateFormat.parse("2017-07-01 01:13:00");
        addDutyStatyChange(onDutyTime1, ON_DUTY, true);

        Date drivingTime1 = dateFormat.parse("2017-07-01 01:13:00");
        addDutyStatyChange(drivingTime1, DRIVING, true);

        EmployeeLogEldEvent[] events = employeeLog.getEldEventList().getEldEventList();

        Assert.assertEquals(4, events.length);

    }

    @Test
    public void AddEventToLogMandate() throws ParseException{

        addDutyStatyChange(dateFormat.parse("2017-07-01 01:10:00"), OFF_DUTY, true);
        Assert.assertEquals(2, employeeLog.getEldEventList().getEldEventList().length);

        addDutyStatyChange(dateFormat.parse("2017-07-01 01:12:00"), ON_DUTY, true);
        Assert.assertEquals(3, employeeLog.getEldEventList().getEldEventList().length);

        //Duplicate event should not be added to list
        addDutyStatyChange(dateFormat.parse("2017-07-01 01:12:01"), DRIVING, true);
        Assert.assertEquals(4, employeeLog.getEldEventList().getEldEventList().length);

        //Making sure we are not removing ON_DUTY Status
        //If the event have the same date will compare with GenericEventComparer which
        //is ordering by (typedAdapter1.getEventCode() < typedAdapter2.getEventCode()) return before else return after
        //That is why we are getting an ON_DUTY at the last position and a DRIVING at the second last
        Assert.assertEquals(employeeLog.getEldEventList().getEldEventList()[ employeeLog.getEldEventList().getEldEventList().length -2 ].getDutyStatusEnum(), ON_DUTY);
        Assert.assertEquals(employeeLog.getEldEventList().getEldEventList()[ employeeLog.getEldEventList().getEldEventList().length -1 ].getDutyStatusEnum(), DRIVING);

        addDutyStatyChange(dateFormat.parse("2017-07-01 01:12:02"), OFF_DUTY, true);
        Assert.assertEquals(5, employeeLog.getEldEventList().getEldEventList().length);
        Assert.assertEquals(employeeLog.getEldEventList().getEldEventList()[ employeeLog.getEldEventList().getEldEventList().length -1 ].getDutyStatusEnum(), OFF_DUTY);

        addDutyStatyChange(dateFormat.parse("2017-07-01 01:15:00"), OFF_DUTY, true);
        Assert.assertEquals(6, employeeLog.getEldEventList().getEldEventList().length);

        addDutyStatyChange(dateFormat.parse("2017-07-01 01:16:00"), SLEEPER, true);
        Assert.assertEquals(7, employeeLog.getEldEventList().getEldEventList().length);
    }

    @Test
    public void testRemoveEventsLog_bugFixOnPbi53093() {
        TimeKeeper mockTimeKeeper = new TestableTimeKeeper(new DateTime(2017, 8, 7, 13, 50));
        TimeKeeper.setTimeKeeper(mockTimeKeeper);

        String destinationLogEventJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":109998,\"eventCode\":1,\"eventDataCheck\":\"33\",\"eventDateTime\":\"Aug 7, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":13,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 12:00:00 AM\",\"primaryKey\":48},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110031,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventComment\":\"hmmmm\",\"eventDataCheck\":\"c1\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":26,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":74},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventComment\":\"dddd\",\"eventDataCheck\":\"d9\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"eventSequenceIDNumber\":43,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":79},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110008,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":24,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":50},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110009,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 4:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":4,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 4:00:00 AM\",\"primaryKey\":49},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110000,\"eventCode\":4,\"eventDataCheck\":\"b4\",\"eventDateTime\":\"Aug 7, 2017 3:42:57 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":14,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:42:57 PM\",\"primaryKey\":52},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110002,\"eventCode\":1,\"eventDataCheck\":\"d4\",\"eventDateTime\":\"Aug 7, 2017 3:43:11 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":16,\"eventType\":\"DutyStatusChange\",\"geolocation\":\"Madison \",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:11 PM\",\"primaryKey\":54},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110004,\"eventCode\":4,\"eventDataCheck\":\"0c\",\"eventDateTime\":\"Aug 7, 2017 3:43:42 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"yii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:42 PM\",\"primaryKey\":56}]";
        ArrayList<EmployeeLogEldEvent> destinationEvents = JsonUtil.getGson().fromJson(destinationLogEventJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        String sourceLogEventJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":109998,\"eventCode\":1,\"eventDataCheck\":\"33\",\"eventDateTime\":\"Aug 7, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":13,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 12:00:00 AM\",\"primaryKey\":48},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110031,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventComment\":\"hmmmm\",\"eventDataCheck\":\"c1\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":26,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":74},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110008,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":24,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":50},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110009,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 4:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":4,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 4:00:00 AM\",\"primaryKey\":49},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110000,\"eventCode\":4,\"eventDataCheck\":\"b4\",\"eventDateTime\":\"Aug 7, 2017 3:42:57 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":14,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:42:57 PM\",\"primaryKey\":52},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110002,\"eventCode\":1,\"eventDataCheck\":\"d4\",\"eventDateTime\":\"Aug 7, 2017 3:43:11 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":16,\"eventType\":\"DutyStatusChange\",\"geolocation\":\"Madison \",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:11 PM\",\"primaryKey\":54},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110004,\"eventCode\":4,\"eventDataCheck\":\"0c\",\"eventDateTime\":\"Aug 7, 2017 3:43:42 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"yii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:42 PM\",\"primaryKey\":56}]";
        ArrayList<EmployeeLogEldEvent> sourceLogEvents = JsonUtil.getGson().fromJson(sourceLogEventJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        //String removedEventsJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110000,\"eventCode\":4,\"eventDataCheck\":\"b4\",\"eventDateTime\":\"Aug 7, 2017 3:42:57 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":14,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:42:57 PM\",\"primaryKey\":52},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110002,\"eventCode\":1,\"eventDataCheck\":\"d4\",\"eventDateTime\":\"Aug 7, 2017 3:43:11 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":16,\"eventType\":\"DutyStatusChange\",\"geolocation\":\"Madison \",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:11 PM\",\"primaryKey\":54},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110004,\"eventCode\":4,\"eventDataCheck\":\"0c\",\"eventDateTime\":\"Aug 7, 2017 3:43:42 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"yii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:42 PM\",\"primaryKey\":56}]";
        String expectedEventsJson = "[{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110031,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventComment\":\"hmmmm\",\"eventDataCheck\":\"c1\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":26,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":74},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventComment\":\"dddd\",\"eventDataCheck\":\"d9\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"eventSequenceIDNumber\":43,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":79},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110008,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":24,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":50},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110000,\"eventCode\":4,\"eventDataCheck\":\"b4\",\"eventDateTime\":\"Aug 7, 2017 3:42:57 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":14,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:42:57 PM\",\"primaryKey\":52},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110002,\"eventCode\":1,\"eventDataCheck\":\"d4\",\"eventDateTime\":\"Aug 7, 2017 3:43:11 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":16,\"eventType\":\"DutyStatusChange\",\"geolocation\":\"Madison \",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:11 PM\",\"primaryKey\":54},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110004,\"eventCode\":4,\"eventDataCheck\":\"0c\",\"eventDateTime\":\"Aug 7, 2017 3:43:42 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"yii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:42 PM\",\"primaryKey\":56}]";
        ArrayList<EmployeeLogEldEvent> expectedEvents = JsonUtil.getGson().fromJson(expectedEventsJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        String expectedSourceLogEventJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":109998,\"eventCode\":1,\"eventDataCheck\":\"33\",\"eventDateTime\":\"Aug 7, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":13,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 12:00:00 AM\",\"primaryKey\":48},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110009,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 4:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":4,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 4:00:00 AM\",\"primaryKey\":49},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110000,\"eventCode\":4,\"eventDataCheck\":\"b4\",\"eventDateTime\":\"Aug 7, 2017 3:42:57 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":14,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:42:57 PM\",\"primaryKey\":52},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110002,\"eventCode\":1,\"eventDataCheck\":\"d4\",\"eventDateTime\":\"Aug 7, 2017 3:43:11 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":16,\"eventType\":\"DutyStatusChange\",\"geolocation\":\"Madison \",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:11 PM\",\"primaryKey\":54},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110004,\"eventCode\":4,\"eventDataCheck\":\"0c\",\"eventDateTime\":\"Aug 7, 2017 3:43:42 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"yii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:42 PM\",\"primaryKey\":56}]";
        ArrayList<EmployeeLogEldEvent> expectedSourceLogEvents = JsonUtil.getGson().fromJson(expectedSourceLogEventJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        EmployeeLog destinationLog = new EmployeeLog();
        destinationLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        destinationLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        destinationLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        destinationLog.getEldEventList().setEldEventList(destinationEvents);

        EmployeeLog sourceLog = new EmployeeLog();
        sourceLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        sourceLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        sourceLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        sourceLog.getEldEventList().setEldEventList(sourceLogEvents);


        EmployeeLog expectedResultLog = new EmployeeLog();
        expectedResultLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        expectedResultLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        expectedResultLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        expectedResultLog.getEldEventList().setEldEventList(expectedEvents);


        EmployeeLog expectedSourceLog = new EmployeeLog();
        expectedSourceLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        expectedSourceLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        expectedSourceLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        expectedSourceLog.getEldEventList().setEldEventList(expectedSourceLogEvents);

        EmployeeLogUtilities.removeEventsForMerging(destinationLog, sourceLog, new DateTime(2017, 8, 7, 12, 1, 27).toDate(), true);

        Assert.assertEquals(expectedResultLog.getEldEventList().getEldEventList().length, destinationLog.getEldEventList().getEldEventList().length);
        for (int i = 0; i < expectedEvents.size(); i++){
            Assert.assertEquals(expectedEvents.get(i).toString(), destinationLog.getEldEventList().getEldEventList()[i].toString());
        }


        Assert.assertEquals(expectedSourceLog.getEldEventList().getEldEventList().length, sourceLog.getEldEventList().getEldEventList().length);
        for (int i = 0; i < expectedSourceLogEvents.size(); i++){
            Assert.assertEquals(expectedSourceLogEvents.get(i).toString(), sourceLog.getEldEventList().getEldEventList()[i].toString());
        }
    }


    @Test
    public void testMergeLog_BugFixOnPbi53093() {
        TimeKeeper mockTimeKeeper = new TestableTimeKeeper(new DateTime(2017, 8, 7, 13, 50));
        TimeKeeper.setTimeKeeper(mockTimeKeeper);


        //Local
        GlobalState.getInstance().getFeatureService().setIsEldMandateEnabled(true);
        String destinationLogEventJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":109998,\"eventCode\":1,\"eventDataCheck\":\"33\",\"eventDateTime\":\"Aug 7, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":13,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 12:00:00 AM\",\"primaryKey\":48},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110031,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventComment\":\"hmmmm\",\"eventDataCheck\":\"c1\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":26,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":74},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventComment\":\"dddd\",\"eventDataCheck\":\"d9\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"eventSequenceIDNumber\":43,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":79},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110008,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":24,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":50},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110009,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 4:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":4,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 4:00:00 AM\",\"primaryKey\":49},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110000,\"eventCode\":1,\"eventDataCheck\":\"b4\",\"eventDateTime\":\"Aug 7, 2017 3:42:57 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":14,\"eventType\":\"LoginLogout\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:42:57 PM\",\"primaryKey\":52},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110002,\"eventCode\":1,\"eventDataCheck\":\"d4\",\"eventDateTime\":\"Aug 7, 2017 3:43:11 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":16,\"eventType\":\"DutyStatusChange\",\"geolocation\":\"Madison \",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:11 PM\",\"primaryKey\":54},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110004,\"eventCode\":4,\"eventDataCheck\":\"0c\",\"eventDateTime\":\"Aug 7, 2017 3:43:42 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"yii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:42 PM\",\"primaryKey\":56}]";
        ArrayList<EmployeeLogEldEvent> destinationEvents = JsonUtil.getGson().fromJson(destinationLogEventJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);


        //Server
        String sourceEventLogJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":109998,\"eventCode\":1,\"eventDataCheck\":\"33\",\"eventDateTime\":\"Aug 7, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":13,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110031,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventComment\":\"hmmmm\",\"eventDataCheck\":\"c1\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":26,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110008,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":24,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110009,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 4:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110000,\"eventCode\":1,\"eventDataCheck\":\"b4\",\"eventDateTime\":\"Aug 7, 2017 3:42:57 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":14,\"eventType\":\"LoginLogout\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":-1,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110002,\"eventCode\":1,\"eventDataCheck\":\"d4\",\"eventDateTime\":\"Aug 7, 2017 3:43:11 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":16,\"eventType\":\"DutyStatusChange\",\"geolocation\":\"Madison \",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":-1,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110004,\"eventCode\":4,\"eventDataCheck\":\"0c\",\"eventDateTime\":\"Aug 7, 2017 3:43:42 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":-1,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"yii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1}]";
        ArrayList<EmployeeLogEldEvent> sourceEvents = JsonUtil.getGson().fromJson(sourceEventLogJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);


        //Result
        String resultEventsJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":109998,\"eventCode\":1,\"eventDataCheck\":\"33\",\"eventDateTime\":\"Aug 7, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":13,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110031,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventComment\":\"hmmmm\",\"eventDataCheck\":\"c1\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":26,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":74},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventComment\":\"dddd\",\"eventDataCheck\":\"d9\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"eventSequenceIDNumber\":43,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":79},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110008,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 2:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":24,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":4,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 2:00:00 AM\",\"primaryKey\":50},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110009,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 4:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110000,\"eventCode\":1,\"eventDataCheck\":\"b4\",\"eventDateTime\":\"Aug 7, 2017 3:42:57 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":14,\"eventType\":\"LoginLogout\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:42:57 PM\",\"primaryKey\":52},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110002,\"eventCode\":1,\"eventDataCheck\":\"d4\",\"eventDateTime\":\"Aug 7, 2017 3:43:11 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":16,\"eventType\":\"DutyStatusChange\",\"geolocation\":\"Madison \",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"iii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:11 PM\",\"primaryKey\":54},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":110004,\"eventCode\":4,\"eventDataCheck\":\"0c\",\"eventDateTime\":\"Aug 7, 2017 3:43:42 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":4,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iii\",\"tractorNumber\":\"yii\",\"trailerNumber\":\"iii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 7, 2017 3:43:42 PM\",\"primaryKey\":56}]";
        ArrayList<EmployeeLogEldEvent> resultEvents = JsonUtil.getGson().fromJson(resultEventsJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        EmployeeLog destinationLog = new EmployeeLog();
        destinationLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        destinationLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        destinationLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        destinationLog.getEldEventList().setEldEventList(destinationEvents.toArray(new EmployeeLogEldEvent[destinationEvents.size()]));

        EmployeeLog sourceLog = new EmployeeLog();
        sourceLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        sourceLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        sourceLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        sourceLog.getEldEventList().setEldEventList(sourceEvents.toArray(new EmployeeLogEldEvent[sourceEvents.size()]));

        EmployeeLog resultLog = new EmployeeLog();
        resultLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        resultLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        resultLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        resultLog.getEldEventList().setEldEventList(resultEvents.toArray(new EmployeeLogEldEvent[resultEvents.size()]));



        EmployeeLogUtilities.mergeLog(GlobalState.getInstance(), destinationLog, sourceLog);

        //Assert.assertEquals(resultLog.getEldEventList().getEldEventList().length, destinationLog.getEldEventList().getEldEventList().length);

        EmployeeLogEldEvent[] actualDestinationEvents = destinationLog.getEldEventList().getActiveEldEventList(EldEventAdapterList.ListAccessorModifierEnum.ALL);
        EmployeeLogEldEvent[] expectedResultEvents = resultLog.getEldEventList().getActiveEldEventList(EldEventAdapterList.ListAccessorModifierEnum.ALL);


        //Assert.assertEquals(expectedResultEvents.length, actualDestinationEvents.length);
        for(int i = 0; i < expectedResultEvents.length; i++){
            Assert.assertEquals(expectedResultEvents[i].toLogString(), actualDestinationEvents[i].toLogString());
        }

    }

    @Test
    public void testMergeLog_ComplexMerge() {
        TimeKeeper mockTimeKeeper = new TestableTimeKeeper(new DateTime(2017, 8, 7, 13, 50));
        TimeKeeper.setTimeKeeper(mockTimeKeeper);


        //Local
        GlobalState.getInstance().getFeatureService().setIsEldMandateEnabled(true);
        String destinationLogEventJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"driversLocationDescription\":\"\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"endOdometer\":-1.0,\"eventCode\":1,\"eventDataCheck\":\"03\",\"eventDateTime\":\"Aug 10, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":1,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":1,\"odometer\":-1.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 10, 2017 12:00:00 AM\",\"primaryKey\":3},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"driversLocationDescription\":\"iuueeii\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":3,\"eventComment\":\"iiuekiii\",\"eventDataCheck\":\"f2\",\"eventDateTime\":\"Aug 10, 2017 4:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":6,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"iueoeui\",\"tractorNumber\":\"kuku\",\"trailerNumber\":\"iiiii\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":3},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 10, 2017 4:00:00 AM\",\"primaryKey\":28},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111389,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"fa\",\"eventDateTime\":\"Aug 10, 2017 4:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":17,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 10, 2017 4:00:00 AM\",\"primaryKey\":11},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"driversLocationDescription\":\"uttututu\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"eventCode\":4,\"eventComment\":\"kuumutu\",\"eventDataCheck\":\"4f\",\"eventDateTime\":\"Aug 10, 2017 5:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":8,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":true,\"isReviewed\":false,\"logKey\":1,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ututtutu\",\"tractorNumber\":\"ututututu\",\"trailerNumber\":\"uhtuttuhhhuhhihu\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 10, 2017 5:00:00 AM\",\"primaryKey\":30},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111390,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"82\",\"eventDateTime\":\"Aug 10, 2017 6:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":1},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 10, 2017 6:00:00 AM\",\"primaryKey\":12},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111384,\"eventCode\":1,\"eventDataCheck\":\"9f\",\"eventDateTime\":\"Aug 10, 2017 3:52:37 PM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":0,\"eventType\":\"LoginLogout\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":1,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"hhggh\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 10, 2017 3:52:37 PM\",\"primaryKey\":13},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111385,\"eventCode\":4,\"eventDataCheck\":\"e7\",\"eventDateTime\":\"Aug 10, 2017 3:53:01 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":2,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":true,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":1,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"hhggh\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"_startTime\":\"Aug 10, 2017 3:53:01 PM\",\"primaryKey\":14}]";
        ArrayList<EmployeeLogEldEvent> destinationEvents = JsonUtil.getGson().fromJson(destinationLogEventJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);


        //Server
        String sourceEventLogJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111383,\"eventCode\":1,\"eventDataCheck\":\"03\",\"eventDateTime\":\"Aug 10, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":1,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111389,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"fa\",\"eventDateTime\":\"Aug 10, 2017 4:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":17,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111390,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"82\",\"eventDateTime\":\"Aug 10, 2017 6:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111384,\"eventCode\":1,\"eventDataCheck\":\"9f\",\"eventDateTime\":\"Aug 10, 2017 3:52:37 PM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":0,\"eventType\":\"LoginLogout\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"hhggh\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111385,\"eventCode\":4,\"eventDataCheck\":\"e7\",\"eventDateTime\":\"Aug 10, 2017 3:53:01 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":2,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":-1,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"hhggh\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1}]";
        ArrayList<EmployeeLogEldEvent> sourceEvents = JsonUtil.getGson().fromJson(sourceEventLogJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);


        String expectedRemovedDestinationEventsJson = "[{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"logKey\":1,\"eventSequenceIDNumber\":1,\"eventRecordStatus\":1,\"eventRecordOrigin\":1,\"eventType\":\"DutyStatusChange\",\"eventCode\":1,\"eventDateTime\":\"Aug 10, 2017 12:00:00 AM\",\"ruleSet\":{\"value\":26},\"odometer\":-1.0,\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driversLocationDescription\":\"\",\"eventDataCheck\":\"03\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"endOdometer\":-1.0,\"isManuallyEditedByKMBUser\":false,\"encompassClusterPK\":0,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":false,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 12:00:00 AM\",\"_dutyStatusEnum\":{\"value\":1},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":3},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"logKey\":1,\"eventSequenceIDNumber\":6,\"eventRecordStatus\":1,\"eventRecordOrigin\":2,\"eventType\":\"DutyStatusChange\",\"eventCode\":3,\"eventDateTime\":\"Aug 10, 2017 4:00:00 AM\",\"ruleSet\":{\"value\":26},\"accumulatedVehicleMiles\":0,\"odometer\":0.0,\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"eventComment\":\"iiuekiii\",\"driversLocationDescription\":\"iuueeii\",\"eventDataCheck\":\"f2\",\"tractorNumber\":\"kuku\",\"trailerNumber\":\"iiiii\",\"shipmentInfo\":\"iueoeui\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":true,\"encompassClusterPK\":0,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":true,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 4:00:00 AM\",\"_dutyStatusEnum\":{\"value\":3},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":28},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"logKey\":1,\"eventSequenceIDNumber\":17,\"eventRecordStatus\":2,\"eventRecordOrigin\":3,\"eventType\":\"DutyStatusChange\",\"eventCode\":4,\"eventDateTime\":\"Aug 10, 2017 4:00:00 AM\",\"ruleSet\":{\"value\":26},\"accumulatedVehicleMiles\":0,\"odometer\":0.0,\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driversLocationDescription\":\"\",\"eventDataCheck\":\"fa\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":true,\"encompassClusterPK\":111389,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":true,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 4:00:00 AM\",\"_dutyStatusEnum\":{\"value\":4},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":11},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"logKey\":1,\"eventSequenceIDNumber\":8,\"eventRecordStatus\":1,\"eventRecordOrigin\":2,\"eventType\":\"DutyStatusChange\",\"eventCode\":4,\"eventDateTime\":\"Aug 10, 2017 5:00:00 AM\",\"ruleSet\":{\"value\":26},\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"eventComment\":\"kuumutu\",\"driversLocationDescription\":\"uttututu\",\"eventDataCheck\":\"4f\",\"tractorNumber\":\"ututututu\",\"trailerNumber\":\"uhtuttuhhhuhhihu\",\"shipmentInfo\":\"ututtutu\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":true,\"encompassClusterPK\":0,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":false,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 5:00:00 AM\",\"_dutyStatusEnum\":{\"value\":4},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":30},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"logKey\":1,\"eventSequenceIDNumber\":0,\"eventRecordStatus\":1,\"eventRecordOrigin\":1,\"eventType\":\"LoginLogout\",\"eventCode\":1,\"eventDateTime\":\"Aug 10, 2017 3:52:37 PM\",\"ruleSet\":{\"value\":26},\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driversLocationDescription\":\"\",\"eventDataCheck\":\"9f\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"shipmentInfo\":\"hhggh\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":false,\"encompassClusterPK\":111384,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":false,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 3:52:37 PM\",\"_dutyStatusEnum\":{\"value\":0},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":13},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"logKey\":1,\"eventSequenceIDNumber\":2,\"eventRecordStatus\":1,\"eventRecordOrigin\":2,\"eventType\":\"DutyStatusChange\",\"eventCode\":4,\"eventDateTime\":\"Aug 10, 2017 3:53:01 PM\",\"ruleSet\":{\"value\":26},\"odometer\":0.0,\"latitude\":-1.0,\"longitude\":-1.0,\"latitudeStatusCode\":\"M\",\"longitudeStatusCode\":\"M\",\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driversLocationDescription\":\"Madison \",\"eventDataCheck\":\"e7\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"shipmentInfo\":\"hhggh\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":false,\"encompassClusterPK\":111385,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":true,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 3:53:01 PM\",\"_dutyStatusEnum\":{\"value\":4},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":14}]";
        ArrayList<EmployeeLogEldEvent> expectedRemovedDestinationEvents = JsonUtil.getGson().fromJson(expectedRemovedDestinationEventsJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        String expectedRemovedSourceEventsJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111383,\"eventCode\":1,\"eventDataCheck\":\"03\",\"eventDateTime\":\"Aug 10, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":1,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111390,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"82\",\"eventDateTime\":\"Aug 10, 2017 6:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":18,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111384,\"eventCode\":1,\"eventDataCheck\":\"9f\",\"eventDateTime\":\"Aug 10, 2017 3:52:37 PM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":0,\"eventType\":\"LoginLogout\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"hhggh\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"driversLocationDescription\":\"Madison \",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":111385,\"eventCode\":4,\"eventDataCheck\":\"e7\",\"eventDateTime\":\"Aug 10, 2017 3:53:01 PM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":2,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"latitudeStatusCode\":\"M\",\"logKey\":-1,\"longitude\":-1.0,\"longitudeStatusCode\":\"M\",\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"hhggh\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_location\":{\"endOdometerReading\":-1.0,\"gpsInfo\":{\"decodedInfo\":{\"city\":\"\",\"country\":\"\",\"county\":\"\",\"postalCode\":\"\",\"state\":\"\",\"street\":\"\",\"primaryKey\":-1},\"latDir\":\"\\u0000\",\"latitudeDeg\":-1.0,\"lonDir\":\"\\u0000\",\"longitudeDeg\":-1.0,\"primaryKey\":-1},\"name\":\"\",\"odometerReading\":-1.0,\"primaryKey\":-1},\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1}]";
        ArrayList<EmployeeLogEldEvent> expectedRemovedSourceEvents = JsonUtil.getGson().fromJson(expectedRemovedSourceEventsJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        //Result
        String resultEventsJson = "[{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"logKey\":1,\"eventSequenceIDNumber\":1,\"eventRecordStatus\":1,\"eventRecordOrigin\":1,\"eventType\":\"DutyStatusChange\",\"eventCode\":1,\"eventDateTime\":\"Aug 10, 2017 12:00:00 AM\",\"ruleSet\":{\"value\":26},\"odometer\":-1.0,\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driversLocationDescription\":\"\",\"eventDataCheck\":\"03\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"endOdometer\":-1.0,\"isManuallyEditedByKMBUser\":false,\"encompassClusterPK\":0,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":false,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 12:00:00 AM\",\"_dutyStatusEnum\":{\"value\":1},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":3},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"logKey\":1,\"eventSequenceIDNumber\":6,\"eventRecordStatus\":1,\"eventRecordOrigin\":2,\"eventType\":\"DutyStatusChange\",\"eventCode\":3,\"eventDateTime\":\"Aug 10, 2017 4:00:00 AM\",\"ruleSet\":{\"value\":26},\"accumulatedVehicleMiles\":0,\"odometer\":0.0,\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"eventComment\":\"iiuekiii\",\"driversLocationDescription\":\"iuueeii\",\"eventDataCheck\":\"f2\",\"tractorNumber\":\"kuku\",\"trailerNumber\":\"iiiii\",\"shipmentInfo\":\"iueoeui\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":true,\"encompassClusterPK\":0,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":true,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 4:00:00 AM\",\"_dutyStatusEnum\":{\"value\":3},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":28},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"logKey\":1,\"eventSequenceIDNumber\":17,\"eventRecordStatus\":2,\"eventRecordOrigin\":3,\"eventType\":\"DutyStatusChange\",\"eventCode\":4,\"eventDateTime\":\"Aug 10, 2017 4:00:00 AM\",\"ruleSet\":{\"value\":26},\"accumulatedVehicleMiles\":0,\"odometer\":0.0,\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driversLocationDescription\":\"\",\"eventDataCheck\":\"fa\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":true,\"encompassClusterPK\":111389,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":true,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 4:00:00 AM\",\"_dutyStatusEnum\":{\"value\":4},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":11},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"logKey\":1,\"eventSequenceIDNumber\":8,\"eventRecordStatus\":1,\"eventRecordOrigin\":2,\"eventType\":\"DutyStatusChange\",\"eventCode\":4,\"eventDateTime\":\"Aug 10, 2017 5:00:00 AM\",\"ruleSet\":{\"value\":26},\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"eventComment\":\"kuumutu\",\"driversLocationDescription\":\"uttututu\",\"eventDataCheck\":\"4f\",\"tractorNumber\":\"ututututu\",\"trailerNumber\":\"uhtuttuhhhuhhihu\",\"shipmentInfo\":\"ututtutu\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":true,\"encompassClusterPK\":0,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":false,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 5:00:00 AM\",\"_dutyStatusEnum\":{\"value\":4},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":30},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"logKey\":1,\"eventSequenceIDNumber\":18,\"eventRecordStatus\":1,\"eventRecordOrigin\":3,\"eventType\":\"DutyStatusChange\",\"eventCode\":1,\"eventDateTime\":\"Aug 10, 2017 6:00:00 AM\",\"ruleSet\":{\"value\":26},\"odometer\":0.0,\"latitude\":-1.0,\"longitude\":-1.0,\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driversLocationDescription\":\"\",\"eventDataCheck\":\"82\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":false,\"encompassClusterPK\":111390,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":true,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 6:00:00 AM\",\"_dutyStatusEnum\":{\"value\":1},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":12},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"logKey\":1,\"eventSequenceIDNumber\":0,\"eventRecordStatus\":1,\"eventRecordOrigin\":1,\"eventType\":\"LoginLogout\",\"eventCode\":1,\"eventDateTime\":\"Aug 10, 2017 3:52:37 PM\",\"ruleSet\":{\"value\":26},\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driversLocationDescription\":\"\",\"eventDataCheck\":\"9f\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"shipmentInfo\":\"hhggh\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":false,\"encompassClusterPK\":111384,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":false,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 3:52:37 PM\",\"_dutyStatusEnum\":{\"value\":0},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":13},{\"driverOriginatorUserId\":\"f4fad4de-42cc-4a92-8dbf-95a2f76ca99d\",\"logKey\":1,\"eventSequenceIDNumber\":2,\"eventRecordStatus\":1,\"eventRecordOrigin\":2,\"eventType\":\"DutyStatusChange\",\"eventCode\":4,\"eventDateTime\":\"Aug 10, 2017 3:53:01 PM\",\"ruleSet\":{\"value\":26},\"odometer\":0.0,\"latitude\":-1.0,\"longitude\":-1.0,\"latitudeStatusCode\":\"M\",\"longitudeStatusCode\":\"M\",\"isGPSAtReducedPrecision\":false,\"eldMalfunctionIndicatorStatus\":false,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driversLocationDescription\":\"Madison \",\"eventDataCheck\":\"e7\",\"tractorNumber\":\"hhhhhh\",\"trailerNumber\":\"mhgh\",\"shipmentInfo\":\"hhggh\",\"originalEvent\":true,\"reassignEvent\":false,\"isEventDateTimeValidated\":true,\"isManuallyEditedByKMBUser\":false,\"encompassClusterPK\":111385,\"unidentifiedEventStatus\":\"NONE\",\"isReviewed\":false,\"relatedKmbPK\":0,\"relatedEncompassClusterPK\":0,\"isEventDataCheckDirty\":true,\"mandateState\":true,\"initializingProcess\":\"MANDATE\",\"_startTime\":\"Aug 10, 2017 3:53:01 PM\",\"_dutyStatusEnum\":{\"value\":4},\"_location\":{\"name\":\"\",\"gpsInfo\":{\"latitudeDeg\":-1.0,\"longitudeDeg\":-1.0,\"decodedInfo\":{\"city\":\"\",\"state\":\"\",\"postalCode\":\"\",\"street\":\"\",\"county\":\"\",\"country\":\"\",\"primaryKey\":-1},\"lonDir\":\"\\u0000\",\"latDir\":\"\\u0000\",\"primaryKey\":-1},\"odometerReading\":-1.0,\"endOdometerReading\":-1.0,\"primaryKey\":-1},\"_isStartTimeValidated\":true,\"_rulesetType\":{\"value\":0},\"_requiresManualLocation\":false,\"primaryKey\":14}]";
        ArrayList<EmployeeLogEldEvent> resultEvents = JsonUtil.getGson().fromJson(resultEventsJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);



        EmployeeLog destinationLog = new EmployeeLog();
        destinationLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        destinationLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        destinationLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        destinationLog.getEldEventList().setEldEventList(destinationEvents);
        GlobalState.getInstance().setCurrentEmployeeLog(destinationLog);

        EmployeeLog sourceLog = new EmployeeLog();
        sourceLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        sourceLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        sourceLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        sourceLog.getEldEventList().setEldEventList(sourceEvents);

        EmployeeLog resultLog = new EmployeeLog();
        resultLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        resultLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        resultLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        resultLog.getEldEventList().setEldEventList(resultEvents);


        //Test Remove events works as expected.
        EmployeeLogUtilities.removeEventsForMerging(destinationLog, sourceLog, new DateTime(2017, 8, 10, 15, 52, 37).toDate(), true);
        for (int i = 0; i < expectedRemovedDestinationEvents.size(); i++){
            Assert.assertEquals(expectedRemovedDestinationEvents.get(i).toString(), destinationLog.getEldEventList().getEldEventList()[i].toString());
        }

        for (int i = 0; i < expectedRemovedSourceEvents.size(); i++){
            Assert.assertEquals(expectedRemovedSourceEvents.get(i).toString(), sourceLog.getEldEventList().getEldEventList()[i].toString());
        }

        //Reset logs
        destinationLog.getEldEventList().setEldEventList(destinationEvents);
        sourceLog.getEldEventList().setEldEventList(sourceEvents);

        EmployeeLogUtilities.mergeLog(GlobalState.getInstance(),  sourceLog, destinationLog);

        //Assert.assertEquals(resultLog.getEldEventList().getEldEventList().length, destinationLog.getEldEventList().getEldEventList().length);

        EmployeeLogEldEvent[] actualDestinationEvents = destinationLog.getEldEventList().getEldEventList();
        EmployeeLogEldEvent[] expectedResultEvents = resultLog.getEldEventList().getEldEventList();


        Assert.assertEquals(expectedResultEvents.length, actualDestinationEvents.length);
        for (int i = 0; i < expectedResultEvents.length; i++){
            Assert.assertEquals(expectedResultEvents[i].toLogString(), actualDestinationEvents[i].toLogString());
        }
        Assert.assertTrue(eldEventCompare(expectedResultEvents[0], actualDestinationEvents[0]));
        Assert.assertTrue(eldEventCompare(expectedResultEvents[1], actualDestinationEvents[1]));
        Assert.assertTrue(eldEventCompare(expectedResultEvents[2], actualDestinationEvents[2]));
        Assert.assertTrue(eldEventCompare(expectedResultEvents[3], actualDestinationEvents[3]));
        Assert.assertTrue(eldEventCompare(expectedResultEvents[4], actualDestinationEvents[4]));
        Assert.assertTrue(eldEventCompare(expectedResultEvents[5], actualDestinationEvents[5]));
        Assert.assertTrue(eldEventCompare(expectedResultEvents[6], actualDestinationEvents[6]));

    }

    @Test
    public void testMergeLog_IdenticalClientServer() {
        TimeKeeper mockTimeKeeper = new TestableTimeKeeper(new DateTime(2017, 8, 7, 13, 50));
        TimeKeeper.setTimeKeeper(mockTimeKeeper);

        //Local
        String destinationLogEventJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":1,\"eventCode\":1,\"eventDataCheck\":\"33\",\"eventDateTime\":\"Aug 7, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":13,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":4,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventComment\":\"hmmmm\",\"eventDataCheck\":\"c1\",\"eventDateTime\":\"Aug 7, 2017 4:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":26,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":5,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 5:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":24,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 5:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":24,\"eventType\":\"LoginLogout\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":6,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 6:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 7:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1}]";
        ArrayList<EmployeeLogEldEvent> destinationEvents = JsonUtil.getGson().fromJson(destinationLogEventJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        //Server
        String sourceEventLogJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":1,\"eventCode\":1,\"eventDataCheck\":\"33\",\"eventDateTime\":\"Aug 7, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":13,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":4,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventComment\":\"hmmmm\",\"eventDataCheck\":\"c1\",\"eventDateTime\":\"Aug 7, 2017 4:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":26,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":5,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 5:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":24,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 5:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":24,\"eventType\":\"LoginLogout\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":6,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 6:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 7:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1}]";
        ArrayList<EmployeeLogEldEvent> sourceEvents = JsonUtil.getGson().fromJson(sourceEventLogJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        //Merged
        String resultEventsJson = "[{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":1,\"eventCode\":1,\"eventDataCheck\":\"33\",\"eventDateTime\":\"Aug 7, 2017 12:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":13,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"driversLocationDescription\":\"hhhmm\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":4,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventComment\":\"hmmmm\",\"eventDataCheck\":\"c1\",\"eventDateTime\":\"Aug 7, 2017 4:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":26,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"shipmentInfo\":\"ggghh\",\"tractorNumber\":\"hhhhh\",\"trailerNumber\":\"mmhhh\",\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":5,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 5:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":2,\"eventSequenceIDNumber\":24,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"accumulatedVehicleMiles\":0,\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"9a\",\"eventDateTime\":\"Aug 7, 2017 5:00:00 AM\",\"eventRecordOrigin\":2,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":24,\"eventType\":\"LoginLogout\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"logKey\":-1,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":6,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":1,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 6:00:00 AM\",\"eventRecordOrigin\":3,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":4},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1},{\"driverDataDiagnosticEventIndicatorStatus\":false,\"driverOriginatorUserId\":\"0c38d810-fb29-41c8-ad9f-2b45509017cd\",\"eldMalfunctionIndicatorStatus\":false,\"encompassClusterPK\":0,\"encompassOriginatorUserId\":\"adecae17-9e99-4600-aa97-ada200c8e67c\",\"eventCode\":4,\"eventDataCheck\":\"a2\",\"eventDateTime\":\"Aug 7, 2017 7:00:00 AM\",\"eventRecordOrigin\":1,\"eventRecordStatus\":1,\"eventSequenceIDNumber\":25,\"eventType\":\"DutyStatusChange\",\"isEventDataCheckDirty\":false,\"isEventDateTimeValidated\":true,\"isGPSAtReducedPrecision\":false,\"isManuallyEditedByKMBUser\":false,\"isReviewed\":false,\"latitude\":-1.0,\"logKey\":-1,\"longitude\":-1.0,\"odometer\":0.0,\"originalEvent\":true,\"reassignEvent\":false,\"relatedEncompassClusterPK\":0,\"relatedKmbPK\":0,\"ruleSet\":{\"value\":26},\"unidentifiedEventStatus\":\"NONE\",\"initializingProcess\":\"MANDATE\",\"mandateState\":true,\"_dutyStatusEnum\":{\"value\":0},\"_isStartTimeValidated\":true,\"_requiresManualLocation\":false,\"_rulesetType\":{\"value\":0},\"primaryKey\":-1}]";
        ArrayList<EmployeeLogEldEvent> resultEvents = JsonUtil.getGson().fromJson(resultEventsJson, JsonUtil.TYPE_LIST_OF_EMPLOYEE_LOG_ELD_EVENT);

        EmployeeLog destinationLog = new EmployeeLog();
        destinationLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        destinationLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        destinationLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        destinationLog.getEldEventList().setEldEventList(destinationEvents.toArray(new EmployeeLogEldEvent[destinationEvents.size()]));

        EmployeeLog sourceLog = new EmployeeLog();
        sourceLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        sourceLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        sourceLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        sourceLog.getEldEventList().setEldEventList(sourceEvents.toArray(new EmployeeLogEldEvent[sourceEvents.size()]));

        EmployeeLog resultLog = new EmployeeLog();
        resultLog.setDriverType(new DriverTypeEnum(DriverTypeEnum.PROPERTYCARRYING));
        resultLog.setLogDate(new DateTime(2017, 8, 7, 0, 0).toDate());
        resultLog.setRuleset(new RuleSetTypeEnum(RuleSetTypeEnum.US60HOUR));
        resultLog.getEldEventList().setEldEventList(resultEvents.toArray(new EmployeeLogEldEvent[resultEvents.size()]));



        EmployeeLogUtilities.mergeLog(GlobalState.getInstance(), destinationLog, sourceLog);

        Assert.assertEquals(resultLog.getEldEventList().getEldEventList().length, destinationLog.getEldEventList().getEldEventList().length);

        EmployeeLogEldEvent[] actualDestinationEvents = destinationLog.getEldEventList().getActiveEldEventList(EldEventAdapterList.ListAccessorModifierEnum.ALL);
        EmployeeLogEldEvent[] expectedResultEvents = resultLog.getEldEventList().getActiveEldEventList(EldEventAdapterList.ListAccessorModifierEnum.ALL);


        Assert.assertEquals(expectedResultEvents.length, actualDestinationEvents.length);
        for(int i = 0; i < expectedResultEvents.length; i++){
            Assert.assertEquals(expectedResultEvents[i].toLogString(), actualDestinationEvents[i].toLogString());
        }
    }


    private static EmployeeLogEldEvent creatEvent(DateTime eventTime, EmployeeLogEldEventCode eventCode, Enums.EmployeeLogEldEventType eventType, int encompassClusterPk){
        EmployeeLogEldEvent event = new EmployeeLogEldEvent(eventTime.toDate(), eventCode, eventType);

        event.setEncompassClusterPK(encompassClusterPk);

        return event;
    }

    private static boolean eldEventCompare(EmployeeLogEldEvent expected, EmployeeLogEldEvent actual){
        boolean eventsAreEqual;
        eventsAreEqual = expected.getEventRecordStatus().equals(actual.getEventRecordStatus());
        eventsAreEqual &= expected.getEventDateTime().equals(actual.getEventDateTime());
        eventsAreEqual &= expected.getEventType() == actual.getEventType();
        eventsAreEqual &= expected.getEncompassClusterPK() == actual.getEncompassClusterPK();
        eventsAreEqual &= expected.getEventCode() == actual.getEventCode();
        return eventsAreEqual;
    }

}